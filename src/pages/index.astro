---
import BaseLayout from '../layouts/BaseLayout.astro';
// ðŸŽ® Learning: Import constants so homepage stays updated automatically!
import { PROJECTS, RESEARCH_PROJECTS } from '../utils/projectConstants.js';

// Get recent items (for now just get all items, but you could sort by date later)
const recentProjects = Object.values(PROJECTS).slice(-3); // Last 3 projects
const recentResearch = Object.values(RESEARCH_PROJECTS).slice(-3); // Last 3 research
---

<BaseLayout title="Home - My Portfolio">
    <!-- Retro screen -->
    <div class="retro-screen">
        <div class="terminal-text">
            <h1>Hello World<span class="cursor"></span></h1>
            <p id="typing-text"></p>
        </div>

        <script>
            // Typing effect - runs when page loads
            const text = "Welcome to Manon's personal webpage, where you can stay up to date with fun projects and research!";
            const typingElement = document.getElementById('typing-text');
            let index = 0;

            function typeWriter() {
                if (typingElement && index < text.length) {
                    // Add one character at a time
                    typingElement.textContent += text.charAt(index);
                    index++;
                    // setTimeout controls typing speed (100ms between letters)
                    setTimeout(typeWriter, 80);
                }
            }

            // Start typing after a short delay
            if (typingElement) {
                setTimeout(typeWriter, 500);
            }
        </script>
    </div>

    <!-- Recent Projects - now dynamic! -->
    <h2>recent_projects</h2>
    
    <div class="projects-scroll">
        {recentProjects.map(project => (
            <!-- ðŸŽ® Learning: This checks if project has a URL vs needs to go to projects page -->
            <a href={project.url || '/projects'} class="project-item">
                <div class="project-icon">{project.icon}</div>
                <h3>{project.name}</h3>
            </a>
        ))}
        
        <!-- ðŸŽ® Learning: If no projects yet, show placeholder -->
        {recentProjects.length === 0 && (
            <div class="project-item">
                <div class="project-icon">ðŸ“¦</div>
                <h3>No projects yet</h3>
            </div>
        )}
    </div>

    <!-- Recent Research - now dynamic! -->
    <h2>recent_research</h2>
    <div class="projects-scroll">
        {recentResearch.map(research => (
            <!-- ðŸŽ® Learning: Use the slug field for consistent URLs -->
            <a href={`/research/${research.slug}`} class="project-item">
                <div class="project-icon">{research.icon}</div>
                <h3>{research.name}</h3>
            </a>
        ))}
        
        <!-- ðŸŽ® Learning: If no research yet, show placeholder -->
        {recentResearch.length === 0 && (
            <div class="project-item">
                <div class="project-icon">ðŸ”¬</div>
                <h3>No research yet</h3>
            </div>
        )}
    </div>
</BaseLayout>